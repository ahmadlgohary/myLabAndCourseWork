/*Join Queries*/

SELECT COACH.COACHNAME, TEAMS.TEAMNAME, TEAMS.NUMBEOF_GOALS, PLAYERS.PLAYERNAME, PLAYERS.GOALS
FROM (PLAYERS
INNER JOIN TEAMS ON (PLAYERS.GOALS >= TEAMS.NUMBEOF_GOALS) AND (PLAYERS.TEAM_NAME = TEAMS.TEAMNAME))
INNER JOIN COACH ON COACH.COACHNAME = TEAMS.COACH_NAME

SELECT TEAMS.numberof_wins, TEAMS.numberof_lost, TEAMS.matplayed, Coach.CoachRecord, Coach.CoachName
FROM TEAMS
LEFT JOIN COACH ON (TEAMS.TeamName != COACH.CoachCountry) AND ((Coach.CoachTeam = TEAMS.TEAMNAME) AND (TEAMS.numberof_wins > TEAMS.numberof_lost));

SELECT TEAMS.country_name, TEAMS.numberof_wins, TEAMS.numberof_lost, PLAYERS.PlayerName, PLAYERS.goals, PLAYERS.PlayerPosition
FROM TEAMS
INNER JOIN PLAYERS
ON PLAYERS.Team_Name = TEAMS.TeamName;

/*views*/

CREATE VIEW TopScorers AS
SELECT PLAYERNAME, GOALS
FROM PLAYERS
ORDER BY GOALS DESC ;

CREATE VIEW TopRedCards AS
SELECT DISTINCT PLAYERNAME, NumOfRedCards
FROM PLAYERS
ORDER BY NumOfRedCards DESC ;

CREATE VIEW TeamslostAlot AS
SELECT country_name, TeamName, numberof_wins
FROM TEAMS
WHERE numberof_wins<numberof_lost;

